# 解决AA-CLIP运行错误问题计划

## 问题分析
用户遇到了两个运行错误：
1. **模型文件缺失**：`RuntimeError: Model /root/autodl-tmp/AA-CLIP_add_mvtec2/model/ViT-L-14-336px.pt not found`
2. **shot参数错误**：`AssertionError: shot should be positive`

## 解决方案

### 1. 解决模型文件缺失问题
- **问题原因**：代码中硬编码了模型文件路径 `model/ViT-L-14-336px.pt`，但该文件不存在
- **解决方案**：
  - 创建下载脚本，从OpenCLIP官方源下载 `ViT-L-14-336px.pt` 模型文件
  - 或者修改代码，使其能够从正确的路径加载模型

### 2. 解决shot参数问题
- **问题原因**：当 `training_mode` 为 `few_shot` 时，代码要求 `shot > 0`，但用户设置了 `shot=0`
- **解决方案**：
  - 修改 `train.py` 代码，在 `shot == 0` 时自动切换到 `full_shot` 模式
  - 或者在命令行中使用正确的参数组合：
    - 使用 `--training_mode full_shot` （忽略shot参数）
    - 或者使用正数的 `--shot` 值，如 `--shot 32`

## 实施步骤

### 步骤1：创建模型下载脚本
- 创建 `download_model.py` 脚本，用于下载 `ViT-L-14-336px.pt` 模型文件
- 脚本应支持从OpenCLIP官方源下载模型并保存到正确位置

### 步骤2：修改train.py代码
- 修改 `train.py` 中的参数处理逻辑，当 `shot == 0` 时自动将 `training_mode` 设置为 `full_shot`
- 这样用户可以继续使用 `--shot 0` 参数而不会触发断言错误

### 步骤3：测试修复
- 运行 `download_model.py` 下载模型文件
- 使用 `python train.py --shot 0 --save_path /root/autodl-tmp/datasets` 测试修复效果
- 确保模型能够正常加载和训练

## 预期结果
- 模型文件成功下载并存储在正确位置
- 即使使用 `--shot 0` 参数，训练也能正常启动
- 项目能够成功运行，开始训练过程